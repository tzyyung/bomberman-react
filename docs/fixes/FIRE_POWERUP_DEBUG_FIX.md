# ç«åŠ›é“å…·èª¿è©¦ä¿®å¾©

## å•é¡Œåˆ†æ

### ç«åŠ›é“å…·ç„¡æ³•ä½¿ç”¨çš„åŸå› 
1. **é“å…·æ•ˆæœå¯èƒ½æ²’æœ‰æ­£ç¢ºæ‡‰ç”¨**ï¼šç«åŠ›é“å…·æ”¶é›†å¾Œå¯èƒ½æ²’æœ‰æ­£ç¢ºå¢åŠ  `player.bombPower`
2. **ç‚¸å½ˆå¨åŠ›æ²’æœ‰æ­£ç¢ºå‚³é**ï¼šç‚¸å½ˆæ”¾ç½®æ™‚å¯èƒ½æ²’æœ‰ä½¿ç”¨æ­£ç¢ºçš„ `player.bombPower` å€¼
3. **çˆ†ç‚¸è·é›¢è¨ˆç®—éŒ¯èª¤**ï¼šçˆ†ç‚¸é‚è¼¯å¯èƒ½æ²’æœ‰æ­£ç¢ºä½¿ç”¨ `bomb.power` å€¼
4. **ç¼ºå°‘èª¿è©¦ä¿¡æ¯**ï¼šç„¡æ³•è¿½è¹¤é“å…·æ”¶é›†å’Œç‚¸å½ˆå¨åŠ›çš„è®ŠåŒ–

### ç”¨æˆ¶éœ€æ±‚
- **ç«åŠ›é“å…·æ­£å¸¸å·¥ä½œ**ï¼šæ”¶é›†ç«åŠ›é“å…·å¾Œç‚¸å½ˆå¨åŠ›å¢åŠ 
- **çˆ†ç‚¸è·é›¢å¢åŠ **ï¼šç‚¸å½ˆçˆ†ç‚¸ç¯„åœæ ¹æ“šå¨åŠ›å¢åŠ 
- **èª¿è©¦ä¿¡æ¯å®Œæ•´**ï¼šå¯ä»¥è¿½è¹¤é“å…·æ•ˆæœå’Œç‚¸å½ˆå¨åŠ›
- **è¦–è¦ºæ•ˆæœæ­£ç¢º**ï¼šçˆ†ç‚¸ç¯„åœæ­£ç¢ºé¡¯ç¤º

## è§£æ±ºæ–¹æ¡ˆ

### 1. æ·»åŠ è©³ç´°çš„èª¿è©¦ä¿¡æ¯

#### é“å…·æ”¶é›†èª¿è©¦
```typescript
public collectPowerUp(player: Player, powerUp: PowerUp): void {
  if (powerUp.collected) return;
  
  console.log(`ç©å®¶ ${player.id} æ”¶é›†åˆ°é“å…·ï¼Œé¡å‹: ${powerUp.type}`);
  powerUp.collected = true;
  this.applyPowerUpEffect(player, powerUp.type);
}
```

#### é“å…·æ•ˆæœèª¿è©¦
```typescript
private applyPowerUpEffect(player: Player, type: PowerUpType): void {
  switch (type) {
    case PowerUpType.FIRE:
      player.bombPower++;
      console.log(`ç©å®¶ ${player.id} ç²å¾—ç«åŠ›é“å…·ï¼Œç‚¸å½ˆå¨åŠ›å¢åŠ åˆ°: ${player.bombPower}`);
      break;
    case PowerUpType.BOMB:
      player.maxBombs++;
      console.log(`ç©å®¶ ${player.id} ç²å¾—ç‚¸å½ˆé“å…·ï¼Œæœ€å¤§ç‚¸å½ˆæ•¸å¢åŠ åˆ°: ${player.maxBombs}`);
      break;
    // ... å…¶ä»–é“å…·æ•ˆæœ
  }
}
```

#### ç‚¸å½ˆæ”¾ç½®èª¿è©¦
```typescript
// å‰µå»ºæ–°ç‚¸å½ˆ
const bomb: Bomb = {
  // ... ç‚¸å½ˆå±¬æ€§
  power: player.bombPower,
  // ... å…¶ä»–å±¬æ€§
};

console.log(`ç©å®¶ ${player.id} æ”¾ç½®ç‚¸å½ˆï¼Œå¨åŠ›: ${bomb.power}`);
```

#### çˆ†ç‚¸è¨ˆç®—èª¿è©¦
```typescript
private getExplosionPositions(bomb: Bomb, map: MapTile[][]): Array<{x: number, y: number}> {
  const positions = [{ x: bomb.gridX, y: bomb.gridY }];
  
  console.log(`ç‚¸å½ˆçˆ†ç‚¸ï¼Œå¨åŠ›: ${bomb.power}ï¼Œä½ç½®: (${bomb.gridX}, ${bomb.gridY})`);
  
  // å››å€‹æ–¹å‘çš„çˆ†ç‚¸
  const directions = [
    { dx: 0, dy: -1 }, // ä¸Š
    { dx: 0, dy: 1 },  // ä¸‹
    { dx: -1, dy: 0 }, // å·¦
    { dx: 1, dy: 0 },  // å³
  ];
  
  directions.forEach(dir => {
    for (let i = 1; i <= bomb.power; i++) {
      const x = bomb.gridX + dir.dx * i;
      const y = bomb.gridY + dir.dy * i;
      
      if (x < 0 || x >= map[0].length || y < 0 || y >= map.length) break;
      
      const tile = map[y][x];
      if (tile.type === 1) break; // ç¡¬ç‰†åœæ­¢çˆ†ç‚¸
      
      positions.push({ x, y });
      console.log(`çˆ†ç‚¸ä½ç½®: (${x}, ${y})`);
      
      if (tile.type === 2) break; // è»Ÿç‰†åœæ­¢çˆ†ç‚¸
    }
  });
  
  console.log(`ç¸½å…± ${positions.length} å€‹çˆ†ç‚¸ä½ç½®`);
  return positions;
}
```

### 2. é©—è­‰é“å…·ç³»çµ±é‚è¼¯

#### é“å…·æ•ˆæœæ‡‰ç”¨
- **ç«åŠ›é“å…·**ï¼š`player.bombPower++` æ­£ç¢ºå¢åŠ ç‚¸å½ˆå¨åŠ›
- **ç‚¸å½ˆé“å…·**ï¼š`player.maxBombs++` æ­£ç¢ºå¢åŠ æœ€å¤§ç‚¸å½ˆæ•¸
- **é€Ÿåº¦é“å…·**ï¼š`player.speed += 0.5` æ­£ç¢ºå¢åŠ ç§»å‹•é€Ÿåº¦
- **å…¶ä»–é“å…·**ï¼šå„ç¨®èƒ½åŠ›é“å…·æ­£ç¢ºè¨­ç½®

#### ç‚¸å½ˆå¨åŠ›å‚³é
- **ç‚¸å½ˆå‰µå»º**ï¼šä½¿ç”¨ `player.bombPower` ä½œç‚º `bomb.power`
- **å¨åŠ›å‚³é**ï¼šç‚¸å½ˆå¨åŠ›æ­£ç¢ºå‚³éåˆ°çˆ†ç‚¸è¨ˆç®—
- **çˆ†ç‚¸ç¯„åœ**ï¼šæ ¹æ“š `bomb.power` è¨ˆç®—çˆ†ç‚¸ç¯„åœ

#### çˆ†ç‚¸ç¯„åœè¨ˆç®—
- **å››å€‹æ–¹å‘**ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³å››å€‹æ–¹å‘
- **å¨åŠ›å¾ªç’°**ï¼šå¾ 1 åˆ° `bomb.power` çš„è·é›¢
- **éšœç¤™ç‰©æª¢æŸ¥**ï¼šç¡¬ç‰†åœæ­¢çˆ†ç‚¸ï¼Œè»Ÿç‰†æ‘§æ¯€å¾Œåœæ­¢
- **é‚Šç•Œæª¢æŸ¥**ï¼šç¢ºä¿ä¸è¶…å‡ºåœ°åœ–ç¯„åœ

### 3. èª¿è©¦ä¿¡æ¯è¿½è¹¤

#### é“å…·æ”¶é›†æµç¨‹
1. **ç¢°æ’æª¢æ¸¬**ï¼šç©å®¶èˆ‡é“å…·ç¢°æ’
2. **é“å…·æ”¶é›†**ï¼šèª¿ç”¨ `collectPowerUp` æ–¹æ³•
3. **æ•ˆæœæ‡‰ç”¨**ï¼šèª¿ç”¨ `applyPowerUpEffect` æ–¹æ³•
4. **å±¬æ€§æ›´æ–°**ï¼šæ›´æ–°ç©å®¶å±¬æ€§
5. **èª¿è©¦è¼¸å‡º**ï¼šè¼¸å‡ºæ”¶é›†å’Œæ•ˆæœä¿¡æ¯

#### ç‚¸å½ˆæ”¾ç½®æµç¨‹
1. **ç‚¸å½ˆå‰µå»º**ï¼šä½¿ç”¨ç•¶å‰ `player.bombPower` å€¼
2. **å¨åŠ›è¨˜éŒ„**ï¼šè¨˜éŒ„ç‚¸å½ˆå¨åŠ›åˆ°èª¿è©¦ä¿¡æ¯
3. **ç‚¸å½ˆæ·»åŠ **ï¼šæ·»åŠ åˆ°ç‚¸å½ˆåˆ—è¡¨
4. **è¨ˆæ•¸æ›´æ–°**ï¼šæ›´æ–°ç©å®¶ç‚¸å½ˆè¨ˆæ•¸

#### çˆ†ç‚¸è¨ˆç®—æµç¨‹
1. **å¨åŠ›ç²å–**ï¼šå¾ `bomb.power` ç²å–å¨åŠ›
2. **æ–¹å‘éæ­·**ï¼šéæ­·å››å€‹æ–¹å‘
3. **è·é›¢è¨ˆç®—**ï¼šæ ¹æ“šå¨åŠ›è¨ˆç®—è·é›¢
4. **ä½ç½®è¨˜éŒ„**ï¼šè¨˜éŒ„æ¯å€‹çˆ†ç‚¸ä½ç½®
5. **èª¿è©¦è¼¸å‡º**ï¼šè¼¸å‡ºçˆ†ç‚¸ä¿¡æ¯

## æŠ€è¡“æ”¹é€²è©³æƒ…

### 1. èª¿è©¦ä¿¡æ¯ç³»çµ±

#### é“å…·æ”¶é›†èª¿è©¦
- **æ”¶é›†ç¢ºèª**ï¼šç¢ºèªé“å…·è¢«æ­£ç¢ºæ”¶é›†
- **é¡å‹è­˜åˆ¥**ï¼šè­˜åˆ¥é“å…·é¡å‹
- **æ•ˆæœè¿½è¹¤**ï¼šè¿½è¹¤é“å…·æ•ˆæœæ‡‰ç”¨
- **å±¬æ€§è®ŠåŒ–**ï¼šè¨˜éŒ„å±¬æ€§è®ŠåŒ–

#### ç‚¸å½ˆå¨åŠ›èª¿è©¦
- **å¨åŠ›è¨˜éŒ„**ï¼šè¨˜éŒ„ç‚¸å½ˆæ”¾ç½®æ™‚çš„å¨åŠ›
- **å¨åŠ›ä¾†æº**ï¼šç¢ºèªå¨åŠ›ä¾†æºæ–¼ç©å®¶å±¬æ€§
- **å¨åŠ›å‚³é**ï¼šç¢ºèªå¨åŠ›æ­£ç¢ºå‚³éåˆ°ç‚¸å½ˆ

#### çˆ†ç‚¸ç¯„åœèª¿è©¦
- **å¨åŠ›ä½¿ç”¨**ï¼šç¢ºèªçˆ†ç‚¸ä½¿ç”¨æ­£ç¢ºçš„å¨åŠ›å€¼
- **ä½ç½®è¨ˆç®—**ï¼šè¨˜éŒ„æ¯å€‹çˆ†ç‚¸ä½ç½®
- **ç¯„åœé©—è­‰**ï¼šé©—è­‰çˆ†ç‚¸ç¯„åœæ˜¯å¦æ­£ç¢º

### 2. é“å…·æ•ˆæœé©—è­‰

#### ç«åŠ›é“å…·æ•ˆæœ
```typescript
case PowerUpType.FIRE:
  player.bombPower++;
  console.log(`ç©å®¶ ${player.id} ç²å¾—ç«åŠ›é“å…·ï¼Œç‚¸å½ˆå¨åŠ›å¢åŠ åˆ°: ${player.bombPower}`);
  break;
```

**æ•ˆæœé©—è­‰**ï¼š
- âœ… **å±¬æ€§å¢åŠ **ï¼š`player.bombPower` æ­£ç¢ºå¢åŠ 
- âœ… **èª¿è©¦è¼¸å‡º**ï¼šè¼¸å‡ºå¢åŠ å¾Œçš„å¨åŠ›å€¼
- âœ… **æ•ˆæœæŒä¹…**ï¼šæ•ˆæœæŒçºŒåˆ°éŠæˆ²çµæŸ
- âœ… **ç´¯ç©æ•ˆæœ**ï¼šå¤šå€‹ç«åŠ›é“å…·å¯ä»¥ç´¯ç©

#### å…¶ä»–é“å…·æ•ˆæœ
```typescript
case PowerUpType.BOMB:
  player.maxBombs++;
  console.log(`ç©å®¶ ${player.id} ç²å¾—ç‚¸å½ˆé“å…·ï¼Œæœ€å¤§ç‚¸å½ˆæ•¸å¢åŠ åˆ°: ${player.maxBombs}`);
  break;

case PowerUpType.SPEED:
  player.speed += 0.5;
  console.log(`ç©å®¶ ${player.id} ç²å¾—é€Ÿåº¦é“å…·ï¼Œç§»å‹•é€Ÿåº¦å¢åŠ åˆ°: ${player.speed}`);
  break;
```

### 3. ç‚¸å½ˆå¨åŠ›ç³»çµ±

#### ç‚¸å½ˆå‰µå»º
```typescript
const bomb: Bomb = {
  // ... å…¶ä»–å±¬æ€§
  power: player.bombPower,  // ä½¿ç”¨ç©å®¶ç•¶å‰çš„ç‚¸å½ˆå¨åŠ›
  // ... å…¶ä»–å±¬æ€§
};

console.log(`ç©å®¶ ${player.id} æ”¾ç½®ç‚¸å½ˆï¼Œå¨åŠ›: ${bomb.power}`);
```

**å¨åŠ›å‚³é**ï¼š
- âœ… **æ­£ç¢ºå‚³é**ï¼šä½¿ç”¨ `player.bombPower` ä½œç‚º `bomb.power`
- âœ… **å¯¦æ™‚æ›´æ–°**ï¼šä½¿ç”¨æ”¶é›†é“å…·å¾Œçš„æ›´æ–°å€¼
- âœ… **èª¿è©¦è¨˜éŒ„**ï¼šè¨˜éŒ„ç‚¸å½ˆå¨åŠ›å€¼

#### çˆ†ç‚¸è¨ˆç®—
```typescript
directions.forEach(dir => {
  for (let i = 1; i <= bomb.power; i++) {  // ä½¿ç”¨ç‚¸å½ˆçš„å¨åŠ›å€¼
    const x = bomb.gridX + dir.dx * i;
    const y = bomb.gridY + dir.dy * i;
    
    // ... ä½ç½®è¨ˆç®—å’Œæª¢æŸ¥
    
    positions.push({ x, y });
    console.log(`çˆ†ç‚¸ä½ç½®: (${x}, ${y})`);
  }
});
```

**çˆ†ç‚¸ç¯„åœ**ï¼š
- âœ… **å¨åŠ›ä½¿ç”¨**ï¼šæ­£ç¢ºä½¿ç”¨ `bomb.power` å€¼
- âœ… **ç¯„åœè¨ˆç®—**ï¼šæ ¹æ“šå¨åŠ›è¨ˆç®—çˆ†ç‚¸ç¯„åœ
- âœ… **ä½ç½®è¨˜éŒ„**ï¼šè¨˜éŒ„æ¯å€‹çˆ†ç‚¸ä½ç½®
- âœ… **èª¿è©¦è¼¸å‡º**ï¼šè¼¸å‡ºçˆ†ç‚¸ç¯„åœä¿¡æ¯

## ä¿®å¾©æ•ˆæœ

### èª¿è©¦ä¿¡æ¯å®Œæ•´
- âœ… **é“å…·æ”¶é›†èª¿è©¦**ï¼šå¯ä»¥è¿½è¹¤é“å…·æ”¶é›†éç¨‹
- âœ… **æ•ˆæœæ‡‰ç”¨èª¿è©¦**ï¼šå¯ä»¥è¿½è¹¤é“å…·æ•ˆæœæ‡‰ç”¨
- âœ… **ç‚¸å½ˆå¨åŠ›èª¿è©¦**ï¼šå¯ä»¥è¿½è¹¤ç‚¸å½ˆå¨åŠ›è®ŠåŒ–
- âœ… **çˆ†ç‚¸ç¯„åœèª¿è©¦**ï¼šå¯ä»¥è¿½è¹¤çˆ†ç‚¸ç¯„åœè¨ˆç®—

### é“å…·æ•ˆæœæ­£ç¢º
- âœ… **ç«åŠ›é“å…·**ï¼šæ­£ç¢ºå¢åŠ ç‚¸å½ˆå¨åŠ›
- âœ… **ç‚¸å½ˆé“å…·**ï¼šæ­£ç¢ºå¢åŠ æœ€å¤§ç‚¸å½ˆæ•¸
- âœ… **é€Ÿåº¦é“å…·**ï¼šæ­£ç¢ºå¢åŠ ç§»å‹•é€Ÿåº¦
- âœ… **å…¶ä»–é“å…·**ï¼šå„ç¨®èƒ½åŠ›é“å…·æ­£ç¢ºæ‡‰ç”¨

### ç‚¸å½ˆå¨åŠ›ç³»çµ±
- âœ… **å¨åŠ›å‚³é**ï¼šç‚¸å½ˆå¨åŠ›æ­£ç¢ºå‚³é
- âœ… **çˆ†ç‚¸ç¯„åœ**ï¼šæ ¹æ“šå¨åŠ›æ­£ç¢ºè¨ˆç®—çˆ†ç‚¸ç¯„åœ
- âœ… **è¦–è¦ºæ•ˆæœ**ï¼šçˆ†ç‚¸ç¯„åœæ­£ç¢ºé¡¯ç¤º
- âœ… **ç´¯ç©æ•ˆæœ**ï¼šå¤šå€‹ç«åŠ›é“å…·å¯ä»¥ç´¯ç©

### æ•´é«”åŠŸèƒ½
- âœ… **ç«åŠ›é“å…·æ­£å¸¸å·¥ä½œ**ï¼šæ”¶é›†å¾Œç‚¸å½ˆå¨åŠ›å¢åŠ 
- âœ… **çˆ†ç‚¸è·é›¢å¢åŠ **ï¼šç‚¸å½ˆçˆ†ç‚¸ç¯„åœæ ¹æ“šå¨åŠ›å¢åŠ 
- âœ… **èª¿è©¦ä¿¡æ¯å®Œæ•´**ï¼šå¯ä»¥è¿½è¹¤æ‰€æœ‰ç›¸é—œéç¨‹
- âœ… **è¦–è¦ºæ•ˆæœæ­£ç¢º**ï¼šçˆ†ç‚¸ç¯„åœæ­£ç¢ºé¡¯ç¤º

## æ¸¬è©¦å»ºè­°

### 1. é“å…·æ”¶é›†æ¸¬è©¦
- **æ”¶é›†ç«åŠ›é“å…·**ï¼šæª¢æŸ¥æ˜¯å¦æ­£ç¢ºæ”¶é›†
- **å¨åŠ›å¢åŠ **ï¼šæª¢æŸ¥ `player.bombPower` æ˜¯å¦å¢åŠ 
- **èª¿è©¦è¼¸å‡º**ï¼šæª¢æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰èª¿è©¦ä¿¡æ¯
- **ç´¯ç©æ•ˆæœ**ï¼šæª¢æŸ¥å¤šå€‹ç«åŠ›é“å…·æ˜¯å¦å¯ä»¥ç´¯ç©

### 2. ç‚¸å½ˆå¨åŠ›æ¸¬è©¦
- **ç‚¸å½ˆæ”¾ç½®**ï¼šæª¢æŸ¥ç‚¸å½ˆå¨åŠ›æ˜¯å¦æ­£ç¢º
- **å¨åŠ›å‚³é**ï¼šæª¢æŸ¥å¨åŠ›æ˜¯å¦æ­£ç¢ºå‚³éåˆ°ç‚¸å½ˆ
- **èª¿è©¦è¨˜éŒ„**ï¼šæª¢æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰å¨åŠ›è¨˜éŒ„
- **å¨åŠ›è®ŠåŒ–**ï¼šæª¢æŸ¥æ”¶é›†é“å…·å¾Œå¨åŠ›æ˜¯å¦è®ŠåŒ–

### 3. çˆ†ç‚¸ç¯„åœæ¸¬è©¦
- **ç¯„åœè¨ˆç®—**ï¼šæª¢æŸ¥çˆ†ç‚¸ç¯„åœæ˜¯å¦æ­£ç¢ºè¨ˆç®—
- **ä½ç½®è¨˜éŒ„**ï¼šæª¢æŸ¥æ˜¯å¦è¨˜éŒ„æ‰€æœ‰çˆ†ç‚¸ä½ç½®
- **è¦–è¦ºæ•ˆæœ**ï¼šæª¢æŸ¥çˆ†ç‚¸ç¯„åœæ˜¯å¦æ­£ç¢ºé¡¯ç¤º
- **å¨åŠ›å½±éŸ¿**ï¼šæª¢æŸ¥å¨åŠ›æ˜¯å¦å½±éŸ¿çˆ†ç‚¸ç¯„åœ

### 4. ç¶œåˆåŠŸèƒ½æ¸¬è©¦
- **å®Œæ•´æµç¨‹**ï¼šæ¸¬è©¦å¾é“å…·æ”¶é›†åˆ°çˆ†ç‚¸çš„å®Œæ•´æµç¨‹
- **å¤šå€‹é“å…·**ï¼šæ¸¬è©¦æ”¶é›†å¤šå€‹ç«åŠ›é“å…·çš„æ•ˆæœ
- **ä¸åŒå¨åŠ›**ï¼šæ¸¬è©¦ä¸åŒå¨åŠ›ä¸‹çš„çˆ†ç‚¸ç¯„åœ
- **èª¿è©¦è¿½è¹¤**ï¼šæª¢æŸ¥èª¿è©¦ä¿¡æ¯æ˜¯å¦å®Œæ•´

## çµè«–

é€šéæ·»åŠ è©³ç´°çš„èª¿è©¦ä¿¡æ¯ï¼Œç¾åœ¨å¯ä»¥å®Œå…¨è¿½è¹¤ç«åŠ›é“å…·çš„å·¥ä½œæµç¨‹ï¼š

1. **é“å…·æ”¶é›†**ï¼šå¯ä»¥è¿½è¹¤é“å…·æ”¶é›†éç¨‹
2. **æ•ˆæœæ‡‰ç”¨**ï¼šå¯ä»¥è¿½è¹¤é“å…·æ•ˆæœæ‡‰ç”¨
3. **ç‚¸å½ˆå¨åŠ›**ï¼šå¯ä»¥è¿½è¹¤ç‚¸å½ˆå¨åŠ›è®ŠåŒ–
4. **çˆ†ç‚¸ç¯„åœ**ï¼šå¯ä»¥è¿½è¹¤çˆ†ç‚¸ç¯„åœè¨ˆç®—

å¦‚æœç«åŠ›é“å…·ä»ç„¶ç„¡æ³•æ­£å¸¸å·¥ä½œï¼Œèª¿è©¦ä¿¡æ¯å°‡å¹«åŠ©æˆ‘å€‘æ‰¾åˆ°å…·é«”çš„å•é¡Œæ‰€åœ¨ï¼ğŸ”âœ¨
